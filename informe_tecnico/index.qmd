---
format:
  html:
    toc: true
    toc-depth: 2
    number-sections: true
execute:
  echo: false
   
---



```{=html}

<style>
    h2 {
        border: none !important;
        box-shadow: none !important;
        border-bottom: none !important;
    }
     img {
        max-width: 100%;
        height: auto;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
</style>
<div style="
    background-color:rgb(255, 255, 255);
    border-radius: 15px;
    padding: 30px;
    text-align: center;
    font-family: Arial, sans-serif;
    color: #333;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);">
    <h1 style="color:rgb(26, 54, 97); font-size: 50px;">Trabajo 3: aplicaciones en sistemas de recomendación e imágenes</h1>
    <h2 style="color: #555;">Redes Neuronales y Algoritmos Bioinspirados</h2>

    <h3 style="color: #222; margin: 10px 0;">Equipo:</h3>
    <ul style="list-style: none; padding: 0; font-size: 20px;">
        <li>Juan José Correa Hurtado</li>
        <li>Jacobo Ochoa Ramírez</li>
    </ul>
    <h3 style="color: #222; margin: 10px 0;">Profesor:</h3>
    <ul style="list-style: none; padding: 0; font-size: 20px;">
        <li>Juan David Ospina Arango</li>
    </ul>
    <h2 style="color: #555;">Universidad Nacional de Colombia</h2>
    <img src="imagenes/logo_UNAL.png" alt="logo UNAL" />
</div>

```
# Índices

## Índice de Contenidos

1. [Introducción](#introducción)  
2. [Objetivos](#objetivos)  
   - [Objetivo General](#objetivo-general)  
   - [Objetivos específicos](#objetivos-especificos)  
3. [Desarrollo del proyecto](#desarrollo-del-proyecto)  
   - [Punto 1: Análisis y Predicción de Demanda Turística](#punto-1-análisis-y-predicción-de-demanda-turística)  
   - [Punto 2: Clasificación de Comportamientos del Conductor](#punto-2-clasificación-de-comportamientos-del-conductor)  
   - [Punto 3: Sistema de Recomendación Híbrido para Destinos Turísticos](#punto-3-sistema-de-recomendación-híbrido-para-destinos-turísticos)  
4. [Referencias](#referencias)


## Índice de Tablas

- **Tabla 1.** Métricas de rendimiento por destino – Sección Evaluación del Modelo

## Índice de Figuras

- **Figura 1.** Ejemplo de predicción de demanda turística – Sección Punto 1  
- **Figura 2.** Matriz de confusión del modelo de clasificación – Sección Punto 2  
- **Figura 3.** Interfaz del sistema de recomendación – Sección Punto 3  


# Introducción

En el contexto actual, las empresas de transporte enfrentan desafíos crecientes relacionados con la eficiencia operativa, la seguridad vial y la satisfacción del usuario. Factores como la variabilidad en la demanda, los riesgos asociados a la conducción distractiva y la necesidad de ofrecer experiencias personalizadas exigen soluciones tecnológicas avanzadas. Este proyecto propone el desarrollo de un sistema inteligente integrado basado en técnicas de aprendizaje profundo, con el objetivo de abordar tres problemáticas clave: la predicción de la demanda de transporte mediante series de tiempo, la clasificación automática de comportamientos distractores en conductores a partir de imágenes, y la recomendación personalizada de destinos de viaje para los usuarios. 

# Objetivos

## Objetivo General

Desarrollar un sistema inteligente integrado basado en aprendizaje profundo que permita predecir la demanda de transporte, clasificar comportamientos distractores en conductores a partir de imágenes y generar recomendaciones personalizadas de destinos de viaje, con el fin de optimizar la eficiencia operativa, mejorar la seguridad vial y elevar la experiencia del usuario en una empresa de transporte.

## Objetivos especificos

1. **Desarrollar un modelo de series de tiempo** que utilice datos históricos para predecir la demanda de transporte en rutas específicas durante los próximos 30 días, facilitando una mejor planificación de recursos.
2. **Entrenar un modelo de clasificación de imágenes** para identificar comportamientos distractores en los conductores, como el uso del teléfono móvil o la somnolencia, con el fin de reducir riesgos de accidentes.
3. **Implementar un sistema de recomendación personalizado** que sugiera destinos de viaje a los usuarios, utilizando información del historial de viajes y preferencias individuales.
4. **Diseñar una herramienta web interactiva** que integre los tres módulos desarrollados, permitiendo la visualización de predicciones, la clasificación de imágenes y la generación de recomendaciones de manera accesible para los usuarios y administradores de la empresa.
5. **Documentar el proceso completo de desarrollo** en un informe técnico.

# Desarrollo del proyecto

## Punto 1: Análisis y Predicción de Demanda Turística

### Revisión y Tratamiento del Dataset

#### Preparación Inicial de los Datos

Se consolidaron todos los datasets disponibles en uno solo para simplificar el análisis y garantizar la consistencia de los datos. Durante esta fase se realizó una revisión exhaustiva que incluyó la identificación de duplicados y valores nulos.

Como paso inicial del análisis exploratorio, se generó una visualización de los destinos más populares, lo que reveló que la base de datos contiene únicamente 5 destinos posibles.

```{=html}
 <img src="imagenes/DestinosPopulares.png" alt="Gráfica 1: Destinos populares" />
```

#### Análisis de Usuarios y Patrones de Viaje

El dataset comprende un total de 642 usuarios únicos. El análisis de frecuencia mostró que el usuario más activo registró 6 visitas, mientras que el segundo y tercer usuario más activos registraron 5 y 4 visitas respectivamente.

Para optimizar el procesamiento y análisis posterior, se realizaron las siguientes transformaciones:

- Conversión de la variable 'VisitDate' a formato datetime, esencial para la creación de la serie temporal
- Estandarización de las variables 'UserID' y 'DestinationId' como strings para garantizar consistencia, calidad y eficiencia del modelo

La distribución de viajes por destino se visualiza en la siguiente gráfica:

```{=html}
 <img src="imagenes/NúmeroViajesDestino.png" alt="Gráfica 2: Número de viajes por destino" />
```

Los resultados muestran una distribución equilibrada entre destinos, sin diferencias significativas en el número de viajes registrados para cada uno.

#### Creación de la Serie Temporal

Se construyó una serie temporal agregada mediante la agrupación por día y destino, contabilizando el número de viajes y ordenando cronológicamente los datos. Durante este proceso se identificó una limitación importante: el dataset contiene únicamente 3 fechas distintas.

Para asegurar la continuidad temporal, se creó un rango continuo de fechas y se reindexaron los datos del destino con mayor volumen de viajes. Posteriormente, se eliminaron los valores nulos y se validó la integridad de la serie temporal resultante.

### Modelado Predictivo con Prophet

#### Justificación del Modelo Seleccionado

Se optó por el modelo Prophet debido a sus características particulares que se adaptan bien a las limitaciones del dataset:

1. Excelente rendimiento con datasets pequeños
2. Capacidad de manejo robusto de series temporales con pocos puntos de datos
3. Diseño específico para prototipado rápido y eficiente

#### Análisis de Predicción Individual

Se realizó una predicción inicial para el destino Kerala Backwaters como caso de estudio:

```{=html}
 <img src="imagenes/PredicciónProphetKeralaBackWaters.png" alt="Gráfica 3: Predicción de demanda para Kerala Backwaters" />
```

La predicción indica un crecimiento constante en la demanda de viajes hacia Kerala, con variaciones estacionales características del comportamiento turístico.

#### Análisis Conjunto de Todos los Destinos

Se generaron predicciones para los 5 destinos y se consolidaron en un dataset unificado. La proyección para los próximos 30 días se presenta a continuación:

```{=html}
 <img src="imagenes/ProyecciónDemanda30Dias.png" alt="Gráfica 4: Proyección de demanda para los próximos 30 días" />
```

#### Interpretación de Resultados

El análisis de las proyecciones revela patrones diferenciados por destino:

- **Jaipur City**: Presenta la mayor probabilidad de crecimiento en demanda
- **Kerala Backwaters**: Muestra un crecimiento moderado pero sostenido
- **Leh Ladakh, Taj Mahal y Goa Beaches**: Exhiben una tendencia decreciente en la demanda proyectada

### Evaluación del Modelo

#### Métricas de Rendimiento

Se evaluó el desempeño del modelo utilizando las métricas RMSE (Root Mean Square Error) y MAE (Mean Absolute Error):

| Destino | RMSE | MAE |
|---------|------|-----|
| Kerala Backwaters | 3.89 | 3.65 |
| Taj Mahal | 1.81 | 1.69 |
| Leh Ladakh | 0.00 | 0.00 |
| Goa Beaches | 2.68 | 2.52 |
| Jaipur City | 0.00 | 0.00 |

```{=html}
 <img src="imagenes/MetricasPorDestino.png" alt="Gráfica 5: Predicción vs Real para cada destino" />
```

#### Análisis de Resultados

Los resultados muestran un rendimiento variable del modelo según el destino:

- **Excelente ajuste**: Leh Ladakh y Jaipur City (RMSE y MAE = 0.00)
- **Ajuste moderado**: Taj Mahal y Goa Beaches
- **Ajuste deficiente**: Kerala Backwaters (paradójicamente el destino con mayor volumen de visitas)

Esta variabilidad sugiere que algunos destinos requieren datasets más extensos y mayor diversidad temporal para lograr predicciones más precisas.

### Análisis de Componentes

Se almacenaron las predicciones individuales por ciudad y se analizaron los componentes de cada modelo:

```{=html}
 <img src="imagenes/ComponentesGoaBeaches.png" alt="Gráfica 6: Componentes destino Goa Beaches" />
 <img src="imagenes/ComponentesJaipurCity.png" alt="Gráfica 7: Componentes destino Jaipur City" />
 <img src="imagenes/ComponentesKeralaBackwaters.png" alt="Gráfica 8: Componentes destino Kerala Backwaters" />
 <img src="imagenes/ComponentesLehLadakh.png" alt="Gráfica 9: Componentes destino Leh Ladakh" />
 <img src="imagenes/ComponentesTajMahal.png" alt="Gráfica 10: Componentes destino Taj Mahal" />
```

### Conclusiones

A pesar de las limitaciones del dataset (únicamente 3 fechas distintas), se observan indicios de variaciones diarias que podrían interpretarse como patrones estacionales con mayor disponibilidad de datos. El modelo Prophet está correctamente estructurado para capturar componentes de tendencia, estacionalidad y efectos temporales cuando se disponga de una serie temporal más extensa.

La arquitectura del modelo proporciona una base sólida para futuras expansiones del análisis con datasets más completos y períodos temporales más amplios.

## Punto 2: Clasificación de Comportamientos del Conductor

### Metodología Implementada

Se desarrolló un sistema de clasificación multiclase para el análisis de comportamientos del conductor utilizando técnicas de aprendizaje profundo. La implementación incluyó:

- **Configuración del entorno**: Configuración de PyTorch con soporte CUDA para procesamiento en GPU
- **Preprocesamiento de datos**: Implementación de una clase `DriverBehaviorDataset` para la gestión de imágenes y etiquetas
- **Entrenamiento del modelo**: Utilización de arquitecturas de CNN preentrenadas para clasificación de comportamientos
- **Evaluación y visualización**: Implementación de métricas de rendimiento y visualización de predicciones

### Tipos de Distracción del Conductor: Análisis y Prevención

#### Clasificación de Distracciones

Existen tres tipos principales de distracción: Visual (apartar los ojos de la carretera), Manual (apartar las manos del volante), y Cognitiva (apartar la mente de la conducción). Esta clasificación es fundamental para comprender los riesgos asociados con diferentes comportamientos del conductor.

##### 1. Distracción Visual
Las distracciones visuales ocurren cuando un conductor aparta la vista de la carretera, lo que lleva a una reducción de la atención. Las principales manifestaciones incluyen:

- Uso de dispositivos electrónicos
- Observación de eventos externos (accidentes, construcciones)
- Lectura de mensajes de texto o navegación GPS
- Atención a pasajeros o objetos en el vehículo

##### 2. Distracción Manual
Las distracciones manuales involucran cualquier acción que mueva las manos del conductor lejos del volante. Los comportamientos más frecuentes son:

- Manipulación de teléfonos celulares
- Ajuste de controles del vehículo (radio, climatización)
- Consumo de alimentos o bebidas
- Alcanzar objetos dentro del vehículo

##### 3. Distracción Cognitiva
Las distracciones cognitivas emergen cuando la mente del conductor se desvía de la tarea de conducir. Incluyen:

- Conversaciones telefónicas (incluso manos libres)
- Preocupaciones personales o laborales
- Concentración en entretenimiento auditivo
- Procesamiento de información compleja mientras se conduce

#### Medidas Preventivas

##### Políticas y Regulación
Las medidas incluyen prohibir el envío de mensajes de texto mientras se conduce, implementar leyes de manos libres y limitar el número de pasajeros jóvenes que pueden viajar con conductores adolescentes. En 2024, los 50 estados han promulgado leyes para frenar la conducción distraída, aunque varían en severidad.

##### Tecnología Preventiva
Las soluciones tecnológicas incluyen:

- **Sistemas de bloqueo de aplicaciones**: Aplicaciones que desactivan funciones del teléfono durante la conducción
- **Sistemas de detección de comportamiento**: Uso de cámaras y sensores para monitorear la atención del conductor
- **Interfaces de voz**: Políticas que prohíben el uso de dispositivos portátiles y manos libres durante la conducción
- **Sistemas de alerta**: Notificaciones cuando se detectan comportamientos de riesgo

##### Educación y Concienciación
Los conductores no deben realizar múltiples tareas y pueden usar aplicaciones para ayudar a evitar el uso del teléfono celular mientras conducen. Las campañas educativas deben enfocarse en:

- Concientización sobre los riesgos de la multitarea
- Promoción de técnicas de conducción defensiva
- Entrenamiento en el uso seguro de tecnologías vehiculares
- Desarrollo de políticas organizacionales para flotas comerciales

#### Impacto Estadístico

Según estudios de NHTSA y VTTI, la distracción ocurrió dentro de los 3 segundos antes del accidente vehicular. El envío de mensajes de texto mientras se conduce es seis veces más mortal que conducir bajo los efectos del alcohol, destacando la severidad de combinar múltiples tipos de distracción.

### Conclusiones del Análisis de Comportamiento

El sistema implementado permite la identificación automatizada de comportamientos de riesgo, proporcionando una base tecnológica para la implementación de medidas preventivas en tiempo real. La combinación de técnicas de visión por computadora con marcos regulatorios y educativos representa un enfoque integral para la reducción de accidentes relacionados con la distracción del conductor.

---

## Punto 3: Sistema de Recomendación Híbrido para Destinos Turísticos

### Marco Conceptual

Los sistemas de recomendación turística han evolucionado hacia enfoques híbridos que combinan múltiples metodologías para superar las limitaciones individuales de cada técnica. Este sistema integra tres paradigmas fundamentales: filtrado colaborativo, filtrado basado en contenido y un enfoque híbrido que aprovecha las fortalezas de ambos métodos.

### Arquitectura del Sistema

#### Filtrado Colaborativo
El filtrado colaborativo se basa en la premisa de que usuarios con preferencias similares en el pasado mantendrán patrones de comportamiento similares en el futuro. La implementación utiliza una matriz usuario-ítem que captura las interacciones históricas entre usuarios y destinos turísticos. A través de técnicas de descomposición matricial, específicamente TruncatedSVD, se reduce la dimensionalidad del espacio de características, permitiendo identificar patrones latentes en los datos de comportamiento del usuario.

La matriz de similitud resultante permite calcular la afinidad entre destinos basándose en las preferencias compartidas de los usuarios. Este enfoque es particularmente efectivo para destinos con un historial rico de interacciones, aunque presenta limitaciones con destinos nuevos o usuarios con pocas interacciones previas.

#### Filtrado Basado en Contenido
El filtrado basado en contenido analiza las características intrínsecas de los destinos turísticos para generar recomendaciones. El sistema procesa múltiples dimensiones de información:

La **popularidad normalizada** representa un indicador cuantitativo del atractivo general del destino, mientras que la **lista de preferencias** codifica características específicas como actividades disponibles, tipo de experiencia turística y amenidades. La **categorización por tipo** permite segmentar destinos según su naturaleza (urbano, natural, cultural, etc.), y la **temporalidad óptima** considera factores estacionales y climáticos.

Estas características se transforman en vectores numéricos mediante técnicas de codificación binaria, permitiendo el cálculo de similitud coseno entre destinos. Esta metodología es especialmente útil para usuarios nuevos o destinos con información limitada de interacciones.

#### Enfoque Híbrido
La combinación de ambos enfoques se realiza mediante una ponderación lineal que equilibra las recomendaciones colaborativas y basadas en contenido. El parámetro alpha controla la contribución relativa de cada método, permitiendo adaptación a diferentes escenarios de uso. Un valor de alpha igual a 0.5 proporciona equilibrio entre ambos enfoques, mientras que valores extremos favorecen uno u otro método.

### Modalidades de Recomendación

#### Recomendación para Usuarios Registrados
Para usuarios con historial de interacciones, el sistema emplea un proceso de múltiples etapas. Inicialmente, se extraen las interacciones previas del usuario para construir su perfil de preferencias. Posteriormente, se calculan puntajes independientes utilizando filtrado colaborativo y basado en contenido, considerando la similitud con destinos previamente visitados o evaluados positivamente.

La combinación híbrida genera un puntaje unificado que refleja tanto las preferencias implícitas del usuario como las características objetivas de los destinos. El sistema excluye destinos ya visitados para evitar recomendaciones redundantes y selecciona los destinos con mayor puntaje combinado.

#### Recomendación por Perfil de Usuario
Para usuarios sin historial o visitantes ocasionales, el sistema procesa perfiles declarativos que incluyen preferencias explícitas, características demográficas y requerimientos específicos del viaje. Esta modalidad construye un vector de preferencias sintético que se compara directamente con las características de los destinos disponibles.

La similitud coseno entre el perfil del usuario y los vectores de destinos permite identificar opciones altamente compatibles, aunque esta aproximación está limitada por la calidad y completitud de la información proporcionada por el usuario.

### Evaluación de Rendimiento

#### Métricas de Evaluación
La evaluación del sistema se realizó utilizando un conjunto de 50 perfiles aleatorios representativos de diferentes segmentos de usuarios. Las métricas principales incluyen precisión y recall, calculadas comparando las recomendaciones generadas con destinos considerados relevantes para cada perfil.

#### Análisis de Resultados
Los resultados obtenidos revelan una **precisión promedio del 27.9%** y un **recall promedio del 65.5%**. La precisión relativamente baja indica que aproximadamente 7 de cada 10 recomendaciones no son percibidas como altamente relevantes por los usuarios, sugiriendo oportunidades de mejora en la selectividad del algoritmo.

El recall moderado demuestra que el sistema captura aproximadamente dos tercios de los destinos potencialmente relevantes, indicando una cobertura aceptable del espacio de soluciones. Este patrón es típico de sistemas que priorizan la diversidad sobre la precisión estricta.


### Direcciones de Mejora

### Agregar más información del dataset para realizar la predicción.

#### Optimización Algorítmica
Las mejoras futuras incluyen el refinamiento de funciones de similitud mediante técnicas de aprendizaje automático más sofisticadas, la incorporación de retroalimentación implícita del usuario y la implementación de algoritmos de optimización para el ajuste automático del parámetro alpha.

#### Enriquecimiento de Datos
La expansión del conjunto de características de destinos, incluyendo información contextual como eventos locales, condiciones meteorológicas y precios dinámicos, podría mejorar significativamente la precisión de las recomendaciones.

#### Validación Metodológica
La implementación de técnicas de validación cruzada más robustas y el uso de métricas adicionales como diversidad y novedad de recomendaciones proporcionaría una evaluación más comprehensiva del rendimiento del sistema.

### Conclusiones

El sistema de recomendación híbrido implementado representa un enfoque técnicamente sólido para la personalización de sugerencias turísticas. Los resultados iniciales demuestran capacidad operativa con oportunidades claras de optimización. La arquitectura modular facilita futuras iteraciones y mejoras incrementales, posicionando el sistema como una base escalable para aplicaciones turísticas personalizadas.

---

# Referencias

1. Taylor, S. J., & Letham, B. (2017). Forecasting at scale. *PeerJ Preprints*, 5, e3190v2. https://doi.org/10.7287/peerj.preprints.3190v2

2. Centers for Disease Control and Prevention. (2024, August 27). Distracted Driving. *CDC Transportation Safety*. https://www.cdc.gov/distracted-driving/about/index.html

3. California Department of Motor Vehicles. (2023, August 18). Driver Distractions. *DMV Educational Materials*. https://www.dmv.ca.gov/portal/driver-education-and-safety/educational-materials/fast-facts/driver-distractions-ffdl-28/

4. National Highway Traffic Safety Administration. (2012, February 24). Visual-Manual NHTSA Driver Distraction Guidelines for In-Vehicle Electronic Devices. *Federal Register*. https://www.federalregister.gov/documents/2012/02/24/2012-4017/visual-manual-nhtsa-driver-distraction-guidelines-for-in-vehicle-electronic-devices

5. Georgia Auto Law. (2024, August 14). Visual, Cognitive and Manual Distracted Driving. https://georgiaautolaw.com/visual-cognitive-an-manual-distracted-driving/

6. Defensive Drivers Institute. (2024, September 26). Distracted Driving Statistics & Facts for 2024. https://defensivedriversinstitute.com/distracted-driving-statistics-and-facts-for-2024/

7. 855MIKEWINS. (2024, June 5). Cognitive, Visual, and Manual Distractions: a Lethal Driving Trifecta. https://www.855mikewins.com/cognitive-visual-and-manual-distractions-a-lethal-driving-trifecta/
